# --- Gateway Connection ---
gateways:
  duckdb:
    connection:
      type: duckdb
      extensions:
        - httpfs
        - aws
        - ducklake
        - spatial
      catalogs:
        duckdb: "{{ env_var('DUCKDB_DATABASE', '../data/nyc_database.duckdb') }}"
        ducklake:
          type: ducklake
          path: "ducklake:../data/analytics_metadata.ducklake"
          data_path: s3://warehouse
      secrets:
        - type: s3
          key_id: "{{ env_var('AWS_ACCESS_KEY_ID') }}"
          secret: "{{ env_var('AWS_SECRET_ACCESS_KEY') }}"
          region: "{{ env_var('AWS_REGION', 'us-east-1') }}"
          endpoint: "127.0.0.1:9000"
          use_ssl: False
          url_style: path

  snowflake:
    connection:
      type: snowflake
      user: "{{ env_var('SNOWFLAKE_USER') }}"
      authenticator: "externalbrowser"
      account: "{{ env_var('SNOWFLAKE_ACCOUNT') }}"
      database: "{{ env_var('SNOWFLAKE_DATABASE', 'nyc_database') }}"
      warehouse: "{{ env_var('SNOWFLAKE_WAREHOUSE', 'compute_wh') }}"
      role: "{{ env_var('SNOWFLAKE_ROLE_SQLMESH', 'sqlmesh') }}"
    state_connection:
      type: duckdb
      database: "../data/sqlmesh_snowflake_state.db"

# Default gateway based on environment
default_gateway: duckdb

# --- Model Defaults ---
model_defaults:
  dialect: duckdb
  start: 2024-01-01
  cron: '@daily'
  owner: "data-platform-team"

# --- Linting Rules ---
linter:
  enabled: true
  rules:
    - ambiguousorinvalidcolumn
    - invalidselectstarexpansion
